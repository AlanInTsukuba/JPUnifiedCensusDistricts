---
title: "Japan Census Shapefiles"
output: rmarkdown::pdf_document
bibliography: jpucdbib.bib
vignette: >
  %\VignetteIndexEntry{Japan Census Shapefiles}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(jpucd)
```
This package includes shapefiles for local census districts in Ibaraki Prefecture covering 
    the six censuses. These as well as shapefiles for all prefectures can also be downloaded from 
    [e-Stat](https://www.e-stat.go.jp/gis/statmap-search?page=1&type=2&aggregateUnitForBoundary=A&toukeiCode=00200521).

# Original files

The original shapefiles are in kmz format wrapped in a zip file. The first task is to extract and 
    convert these to geojson. A kmz file is a zipped kml file so the first step is to unzip twice.

Copies of the original files for Ibaraki Prefecture are in extdata.
```{r}
list.files(system.file("extdata",package="jpucd"))
```
openkmzzip places the contained kml file in the R temp file folder and returns its path.

```{r}
library(jpucd)
shppath <- system.file("extdata",package="jpucd")
shpfile <- paste(shppath,list.files(shppath,pattern=".zip")[1],sep="/")
kmlfile <- openkmzzip(shpfile)
```

These Japanese census shapefiles conform to [KML 2.2](http://www.opengis.net/kml/2.2). Each Placemark element 
    contains ExtendedData that is particularly useful for identifying placemarks and can be used 
    for developing mappings from postal addresses to census districts. 
